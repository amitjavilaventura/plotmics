<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>expressionCor — expressionCor • plotmics</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="expressionCor — expressionCor"><meta property="og:description" content="Function that takes a data frame with a Geneid column and several columns for
expression data of different samples (e.g. TPMs, Log2FC...) and draws a correlation plot"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plotmics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">7.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/00-install_and_sessioninfo.html">Install plotmics + Session info</a>
    </li>
    <li>
      <a href="../articles/01-chromReads.html">chromReads()</a>
    </li>
    <li>
      <a href="../articles/02-barDEGs.html">barDEGs()</a>
    </li>
    <li>
      <a href="../articles/03-volcanoPlot.html">volcanoPlot()</a>
    </li>
    <li>
      <a href="../articles/04-DEcompare.html">DEcompare()</a>
    </li>
    <li>
      <a href="../articles/05-barAnno.html">barAnno()</a>
    </li>
    <li>
      <a href="../articles/06-upSetPeaks.html">upsetPeaks()</a>
    </li>
    <li>
      <a href="../articles/07-ggUpsetPeaks.html">ggUpsetPeaks()</a>
    </li>
    <li>
      <a href="../articles/08-ggVennPeaks.html">ggVennPeaks()</a>
    </li>
    <li>
      <a href="../articles/09-expressionHeatmap.html">expressionHeatmap()</a>
    </li>
    <li>
      <a href="../articles/10-expressionHeatmap2.html">expressionHeatmap2()</a>
    </li>
    <li>
      <a href="../articles/11-chromRegions.html">chromRegions()</a>
    </li>
    <li>
      <a href="../articles/12-circleRegions.html">circleRegions()</a>
    </li>
    <li>
      <a href="../articles/13-ggVennBed.html">ggVennBed()</a>
    </li>
    <li>
      <a href="../articles/14-expressionCor.html">expressionCor()</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/amitjavilaventura/plotmics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>expressionCor</h1>
    <small class="dont-index">Source: <a href="https://github.com/amitjavilaventura/plotmics/blob/HEAD/R/expressionCor.R" class="external-link"><code>R/expressionCor.R</code></a></small>
    <div class="hidden name"><code>expressionCor.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function that takes a data frame with a Geneid column and several columns for
expression data of different samples (e.g. TPMs, Log2FC...) and draws a correlation plot</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">expressionCor</span><span class="op">(</span></span>
<span>  <span class="va">df</span>,</span>
<span>  genes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  samples <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  samples_order <span class="op">=</span> <span class="va">samples</span>,</span>
<span>  corr_method <span class="op">=</span> <span class="st">"pearson"</span>,</span>
<span>  plot_type <span class="op">=</span> <span class="st">"lower"</span>,</span>
<span>  plot_diagonal <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_size <span class="op">=</span> <span class="fl">85</span>,</span>
<span>  plot_border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Gold3"</span>, <span class="st">"White"</span>, <span class="st">"Cornflowerblue"</span><span class="op">)</span>,</span>
<span>  plot_title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_subtitle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  plot_caption <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cell_border <span class="op">=</span> <span class="st">"Black"</span>,</span>
<span>  legend_pos <span class="op">=</span> <span class="st">"right"</span>,</span>
<span>  legend_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="va">plot_size</span><span class="op">)</span>,</span>
<span>  legend_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  legend_breaks_by <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  legend_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/case.html" class="external-link">str_to_sentence</a></span><span class="op">(</span><span class="va">corr_method</span><span class="op">)</span>, <span class="st">"correlation"</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span>,</span>
<span>  legend_title_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  legend_frame_width <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  ticks <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  ticks_color <span class="op">=</span> <span class="st">"Black"</span>,</span>
<span>  coeffs_color <span class="op">=</span> <span class="st">"Black"</span>,</span>
<span>  coeffs_size <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  title_hjust <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  title_face <span class="op">=</span> <span class="st">"plain"</span>,</span>
<span>  title_size <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  subtitle_face <span class="op">=</span> <span class="st">"italic"</span>,</span>
<span>  subtitle_size <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  caption_size <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  axis_text_size <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  axis_text_color <span class="op">=</span> <span class="st">"black"</span>,</span>
<span>  by_groups <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>Dataframe with a 'Geneid' column and several columns with numerical expression data for different samples, such as TPMs or Log2FC.</p></dd>


<dt id="arg-genes">genes<a class="anchor" aria-label="anchor" href="#arg-genes"></a></dt>
<dd><p>Character or NULL. Names of the genes to be used for the correlation analysis. They must present in the column 'Geneid' of 'df'. If NULL, all genes in the data frame are used. Default: NULL</p></dd>


<dt id="arg-samples">samples<a class="anchor" aria-label="anchor" href="#arg-samples"></a></dt>
<dd><p>Character or NULL. Names of the samples to be used for the correlation analysis. They must be column names of 'df'. If NULL, all samples are used. Default: NULL.</p></dd>


<dt id="arg-corr-method">corr_method<a class="anchor" aria-label="anchor" href="#arg-corr-method"></a></dt>
<dd><p>Character of length 1. Correlation method to be passed through <code><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor()</a></code>. One of <code>"pearson"</code>, <code>"spearman"</code> or <code>"kendall"</code>. Default: "pearson".</p></dd>


<dt id="arg-plot-type">plot_type<a class="anchor" aria-label="anchor" href="#arg-plot-type"></a></dt>
<dd><p>Character of length 1. Type of the correlation plot. One of <code>"full"</code>, <code>"upper"</code> or <code>"lower"</code>. Default: "lower".</p></dd>


<dt id="arg-plot-diagonal">plot_diagonal<a class="anchor" aria-label="anchor" href="#arg-plot-diagonal"></a></dt>
<dd><p>Logical of length 1. Whether to plot the diagonal or not if the plot type is upper or lower. Default: TRUE.</p></dd>


<dt id="arg-plot-size">plot_size<a class="anchor" aria-label="anchor" href="#arg-plot-size"></a></dt>
<dd><p>Numerical of length 1. Size in milimeters of the plot. The same number is used for plot height and plot width Default: 85.</p></dd>


<dt id="arg-plot-border">plot_border<a class="anchor" aria-label="anchor" href="#arg-plot-border"></a></dt>
<dd><p>Logical of length 1. Whether to draw a border in the panel or not. Default: TRUE.</p></dd>


<dt id="arg-plot-colors">plot_colors<a class="anchor" aria-label="anchor" href="#arg-plot-colors"></a></dt>
<dd><p>Character of length 3. Colors of the lower, midpoint and higher limits of the scale. Default: c("Gold3", "White", "Cornflowerblue").</p></dd>


<dt id="arg-plot-title">plot_title<a class="anchor" aria-label="anchor" href="#arg-plot-title"></a></dt>
<dd><p>Character of length 1 or NULL. Title of the plot. Defalut: NULL.</p></dd>


<dt id="arg-plot-subtitle">plot_subtitle<a class="anchor" aria-label="anchor" href="#arg-plot-subtitle"></a></dt>
<dd><p>Character of length 1 or NULL. Subtitle of the plot. Defalut: NULL.</p></dd>


<dt id="arg-plot-caption">plot_caption<a class="anchor" aria-label="anchor" href="#arg-plot-caption"></a></dt>
<dd><p>Character of length 1 or NULL. Caption of the plot. Defalut: NULL.</p></dd>


<dt id="arg-cell-border">cell_border<a class="anchor" aria-label="anchor" href="#arg-cell-border"></a></dt>
<dd><p>Charachter of length 1, NULL or NA. Color of the cell border. Default: "Black".</p></dd>


<dt id="arg-legend-pos">legend_pos<a class="anchor" aria-label="anchor" href="#arg-legend-pos"></a></dt>
<dd><p>Charachter of length 1. Position of the legend, to be passed through <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">ggpubr::theme_pubr()</a></code>. Default: "right".</p></dd>


<dt id="arg-legend-size">legend_size<a class="anchor" aria-label="anchor" href="#arg-legend-size"></a></dt>
<dd><p>Numerical of length 2. Size of the legend. The first element is the width and the second is the height of the legend bar. Default: c(8,plot_size)</p></dd>


<dt id="arg-legend-limits">legend_limits<a class="anchor" aria-label="anchor" href="#arg-legend-limits"></a></dt>
<dd><p>Numerical of length 2. Lower and upper limits of the correlation scale. Default: c(-1,1).</p></dd>


<dt id="arg-legend-breaks-by">legend_breaks_by<a class="anchor" aria-label="anchor" href="#arg-legend-breaks-by"></a></dt>
<dd><p>Numerical of length 1. Size of the breaks in the legend. Default: 0.5.</p></dd>


<dt id="arg-legend-title">legend_title<a class="anchor" aria-label="anchor" href="#arg-legend-title"></a></dt>
<dd><p>Character of length 1 or NULL. Title of the legend. Default: <code>paste(stringr::str_to_sentence(corr_method), "correlation", sep = " ")</code>.</p></dd>


<dt id="arg-legend-title-size">legend_title_size<a class="anchor" aria-label="anchor" href="#arg-legend-title-size"></a></dt>
<dd><p>Numerical of length 1. Size of the legend title. Default: 10.</p></dd>


<dt id="arg-legend-frame-width">legend_frame_width<a class="anchor" aria-label="anchor" href="#arg-legend-frame-width"></a></dt>
<dd><p>Numerical of length 1. Width of the line surrounding the colorbar legend. Default: 0.5.</p></dd>


<dt id="arg-ticks">ticks<a class="anchor" aria-label="anchor" href="#arg-ticks"></a></dt>
<dd><p>Logical of length 1. Whether to show the ticks of the colourbar legend or not. Default: FALSE.</p></dd>


<dt id="arg-ticks-color">ticks_color<a class="anchor" aria-label="anchor" href="#arg-ticks-color"></a></dt>
<dd><p>Character of length 1. Color of the ticks of the colourbar legend. Default: "Black".</p></dd>


<dt id="arg-coeffs-color">coeffs_color<a class="anchor" aria-label="anchor" href="#arg-coeffs-color"></a></dt>
<dd><p>Character of length 1 or NULL. Color of the correlation coeficients to be plotted. If NULL, no correlation coefficients are plotted. Default: "Black".</p></dd>


<dt id="arg-coeffs-size">coeffs_size<a class="anchor" aria-label="anchor" href="#arg-coeffs-size"></a></dt>
<dd><p>Numerical of length 1. Size of the correlation coefficients. Default: 4.</p></dd>


<dt id="arg-title-hjust">title_hjust<a class="anchor" aria-label="anchor" href="#arg-title-hjust"></a></dt>
<dd><p>Numerical of length 1. Horizontal justification of the title and the subtitle. Default: 0.5.</p></dd>


<dt id="arg-title-face">title_face<a class="anchor" aria-label="anchor" href="#arg-title-face"></a></dt>
<dd><p>Character of length 1. Face of the title text. One of "plain", "italic", "bold". Default: "plain".</p></dd>


<dt id="arg-title-size">title_size<a class="anchor" aria-label="anchor" href="#arg-title-size"></a></dt>
<dd><p>Numerical of length 1. Size of the title text. Default: 12.</p></dd>


<dt id="arg-subtitle-face">subtitle_face<a class="anchor" aria-label="anchor" href="#arg-subtitle-face"></a></dt>
<dd><p>Character of length 1. Face of the subtitle text. One of "plain", "italic", "bold". Default: "italic".</p></dd>


<dt id="arg-subtitle-size">subtitle_size<a class="anchor" aria-label="anchor" href="#arg-subtitle-size"></a></dt>
<dd><p>Numerical of length 1. Size of the subtitle text. Default: 11.</p></dd>


<dt id="arg-caption-size">caption_size<a class="anchor" aria-label="anchor" href="#arg-caption-size"></a></dt>
<dd><p>Numerical of length 1. Size of the plot caption. Default: 6.</p></dd>


<dt id="arg-axis-text-size">axis_text_size<a class="anchor" aria-label="anchor" href="#arg-axis-text-size"></a></dt>
<dd><p>Numerical of length 1. Size of the text in the axes. Default: 7.</p></dd>


<dt id="arg-axis-text-color">axis_text_color<a class="anchor" aria-label="anchor" href="#arg-axis-text-color"></a></dt>
<dd><p>Character of length 1. Color of the text in the axes. Default: "Black".</p></dd>


<dt id="arg-by-groups">by_groups<a class="anchor" aria-label="anchor" href="#arg-by-groups"></a></dt>
<dd><p>Logical of length 1. If TRUE, the function searches an extra column named 'group', whose values will be used to separate the plot into facets using facet_wrap(). Default: FALSE.</p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>amitjavilaventura</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Adria Mitjavila Ventura.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

