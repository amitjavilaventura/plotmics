<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>circleRegions() • plotmics</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="circleRegions()">
<meta property="og:description" content="plotmics">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">plotmics</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">6.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/00-install_and_sessioninfo.html">Install plotmics + Session info</a>
    </li>
    <li>
      <a href="../articles/01-chromReads.html">chromReads()</a>
    </li>
    <li>
      <a href="../articles/02-barDEGs.html">barDEGs()</a>
    </li>
    <li>
      <a href="../articles/03-volcanoPlot.html">volcanoPlot()</a>
    </li>
    <li>
      <a href="../articles/04-DEcompare.html">DEcompare()</a>
    </li>
    <li>
      <a href="../articles/05-barAnno.html">barAnno()</a>
    </li>
    <li>
      <a href="../articles/06-upSetPeaks.html">upsetPeaks()</a>
    </li>
    <li>
      <a href="../articles/07-ggUpsetPeaks.html">ggUpsetPeaks()</a>
    </li>
    <li>
      <a href="../articles/08-ggVennPeaks.html">ggVennPeaks()</a>
    </li>
    <li>
      <a href="../articles/09-expressionHeatmap.html">expressionHeatmap()</a>
    </li>
    <li>
      <a href="../articles/10-expressionHeatmap2.html">expressionHeatmap2()</a>
    </li>
    <li>
      <a href="../articles/11-chromRegions.html">chromRegions()</a>
    </li>
    <li>
      <a href="../articles/12-circleRegions.html">circleRegions()</a>
    </li>
    <li>
      <a href="../articles/13-ggVennBed.html">ggVenBed()</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/amitjavilaventura/plotmics/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>circleRegions()</h1>
                        <h4 data-toc-skip class="author">Adrià Mitjavila Ventura</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/amitjavilaventura/plotmics/blob/HEAD/vignettes/12-circleRegions.Rmd" class="external-link"><code>vignettes/12-circleRegions.Rmd</code></a></small>
      <div class="hidden name"><code>12-circleRegions.Rmd</code></div>

    </div>

    
    
<p>Last updated: 2022-02-14</p>
<hr>
<div class="section level1">
<h1 id="load-plotmics">Load <code>plotmics</code><a class="anchor" aria-label="anchor" href="#load-plotmics"></a>
</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load plotmics</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://amitjavilaventura.github.io/plotmics/index.html" class="external-link">plotmics</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level1">
<h1 id="run-circleregions">Run <code>circleRegions()</code><a class="anchor" aria-label="anchor" href="#run-circleregions"></a>
</h1>
<p><code><a href="../reference/chromRegions.html">chromRegions()</a></code> takes a file with the sizes of the chromosomes and draws a <code>ggplot2</code>-based bar plot. Then takes a list of regions in a BED-like format to draw them into each chromosome. The inputs <code>chrom.sizes</code> and <code>regions</code> can be supplied as a list of character with path to the file where the information is stored or a list of data frame.</p>
<div class="section level2">
<h2 id="required-input">Required input<a class="anchor" aria-label="anchor" href="#required-input"></a>
</h2>
<p>The <code>crhom_sizes</code> input is:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chromsizes_sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Regions1"</span> <span class="op">=</span> <span class="st">"../testdata/mm10.chrom.sizes"</span>,
                        <span class="st">"Regions2"</span> <span class="op">=</span> <span class="st">"../testdata/mm10.chrom.sizes"</span>,
                        <span class="st">"Regions3"</span> <span class="op">=</span> <span class="st">"../testdata/mm10.chrom.sizes"</span><span class="op">)</span>
<span class="va">chromsizes_sets</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span>header <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   V1        V2</span>
<span class="co">## 1  1 195471971</span>
<span class="co">## 2 10 130694993</span>
<span class="co">## 3 11 122082543</span>
<span class="co">## 4 12 120129022</span>
<span class="co">## 5 13 120421639</span>
<span class="co">## 6 14 124902244</span></code></pre>
<p>The <code>regions_sets</code> is a list of characters or dataframes. It can have as many elements as wanted and it has the following structure:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">regions_sets</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Regions1"</span> <span class="op">=</span> <span class="st">"../testdata/mm10.regions.tsv"</span>,
                     <span class="st">"Regions2"</span> <span class="op">=</span> <span class="st">"../testdata/mm10.regions2.tsv"</span>,
                     <span class="st">"Regions3"</span> <span class="op">=</span> <span class="st">"../testdata/mm10.regions3.tsv"</span><span class="op">)</span>
<span class="va">regions_sets</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span>header <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   V1        V2        V3       V4    V5 V6</span>
<span class="co">## 1  1  57348975  57377520  region2 28545  -</span>
<span class="co">## 2  1  91403055  91406029  region4  2974  -</span>
<span class="co">## 3  1  92992344  92997067  region6  4723  -</span>
<span class="co">## 4  1 125174891 125177979 region10  3088  +</span>
<span class="co">## 5 10  18796805  18831930 region18 35125  -</span>
<span class="co">## 6 10  20310505  20312760 region19  2255  -</span></code></pre>
</div>
<div class="section level2">
<h2 id="default-run">Default run<a class="anchor" aria-label="anchor" href="#default-run"></a>
</h2>
<p>The default run requires only the <code>chromsizes_sets</code> and the <code>regions_sets</code> arguments, either as a lists of paths to a file or a list of data frames. Both, the <code>chromsizes_sets</code> and the <code>regions_sets</code> arguments, must have the same length and the same order, ii.e. if the regions are from different species, the chromosome sizes must be from the corresponding species in the same order.</p>
<p>If you provide a list with 1 element, only one circle will be drawn. If the list contains three elements, three circles will be drawn.</p>
<p>Here we have a list of 1 element as input.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, regions_sets <span class="op">=</span> <span class="va">regions_sets</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, color_by <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-4-1.png" width="576" style="display: block; margin: auto;"></p>
<p>And here, a list of three elements as input:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, regions_sets <span class="op">=</span> <span class="va">regions_sets</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-5-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Also from a list of data frames:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Read the data</span>
<span class="va">chromsizes</span> <span class="op">=</span> <span class="va">chromsizes_sets</span> <span class="op">%&gt;%</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">.x</span>, header <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span>
<span class="va">regions</span> <span class="op">=</span> <span class="va">regions_sets</span> <span class="op">%&gt;%</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">.x</span>, header <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes</span>, regions_sets <span class="op">=</span> <span class="va">regions</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-6-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="exclude-chromosomes">Exclude chromosomes<a class="anchor" aria-label="anchor" href="#exclude-chromosomes"></a>
</h2>
<p>Very often, the genome assemblies of a lot of species have chromosomes/scaffolds with strange names, which are not nice to plot. These can be excluded using the <code>chr_exlude</code> argument with a vector of regular expressions that match the chromosomes to exclude. By default <code>chr_exclude</code> removes the most usuall <em>strange</em> chromosomes, but if you want to remove more chromosomes or don’t want to remove any, you can change the <code>chr_exclude</code> argument.</p>
<p>An example that excludes all the chromosomes that contain a dot in the name:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, regions_sets <span class="op">=</span> <span class="va">regions_sets</span>, color_by <span class="op">=</span> <span class="st">"region"</span>, chr_exclude <span class="op">=</span> <span class="st">"\\."</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-7-1.png" width="576" style="display: block; margin: auto;"> ## Paired regions</p>
<p>Imagine we have, for each element <code>regions_set</code>, regions that are paired (i.e. have the same id (4th column) in different elements) and we want to connect them. We can do this by setting the <code>paired</code> argument to <code>TRUE</code>, which will cause the function to draw a line connecting the paired regions. The color of the line can be controlled with <code>paired_color</code>, which is <code>"Blue"</code> by default..</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Read the data</span>
<span class="va">chromsizes</span> <span class="op">=</span> <span class="va">chromsizes_sets</span> <span class="op">%&gt;%</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">.x</span>, header <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span>
<span class="va">regions</span> <span class="op">=</span> <span class="va">regions_sets</span> <span class="op">%&gt;%</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="va">.x</span>, header <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Subset one of the regions and enter it as element of regions_sets</span>
<span class="va">regions</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">regions</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>,<span class="op">]</span>
<span class="va">regions</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">regions</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/AnnotationDbi/man/Bimap-envirAPI.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="fl">20</span>, replace <span class="op">=</span> <span class="cn">F</span><span class="op">)</span>,<span class="op">]</span>

<span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes</span>, 
              regions_sets <span class="op">=</span> <span class="va">regions</span>,
              paired <span class="op">=</span> <span class="cn">T</span>, paired_color <span class="op">=</span> <span class="st">"Darkblue"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-8-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="customization">Customization<a class="anchor" aria-label="anchor" href="#customization"></a>
</h2>
<div class="section level3">
<h3 id="draw-the-points">Draw the points<a class="anchor" aria-label="anchor" href="#draw-the-points"></a>
</h3>
<p>By default, <code><a href="../reference/circleRegions.html">circleRegions()</a></code> draws a line/rectangle and a point in the middle of each region. To avoid drawing the points, the argument <code>draw_points</code> can be set to FALSE.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, regions_sets <span class="op">=</span> <span class="va">regions_sets</span>, draw_points <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-9-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="chromosome-labels">Chromosome labels<a class="anchor" aria-label="anchor" href="#chromosome-labels"></a>
</h3>
<p>By default, if all the elements in <code>chromsizes_sets</code> are equal, <code><a href="../reference/circleRegions.html">circleRegions()</a></code> only draws the labels of the chromosomes in the outer side of the most external circle. However, if they are not equal (i.e. different file names or different information in the dataframe (only between first and second elements)), they are plotted in all the circles. The color of the labels can be controlled with <code>chr_label</code>, which is <code>"Black"</code> by default.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">chromsizes_sets2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"Regions1"</span> <span class="op">=</span> <span class="st">"../testdata/mm10.chrom.sizes"</span>,
                         <span class="st">"Regions2"</span> <span class="op">=</span> <span class="st">"../testdata/mm10.chrom.sizes2"</span><span class="op">)</span>

<span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets2</span>, regions_sets <span class="op">=</span> <span class="va">regions_sets</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span>, chr_label <span class="op">=</span> <span class="st">"Red"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="chromosome-lines">Chromosome lines<a class="anchor" aria-label="anchor" href="#chromosome-lines"></a>
</h3>
<p>By default, <code><a href="../reference/circleRegions.html">circleRegions()</a></code> does not plot any lines to separate the chromosomes. This can be reversed by setting <code>chr_line</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, regions_sets <span class="op">=</span> <span class="va">regions_sets</span>, chr_line <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="color">Color<a class="anchor" aria-label="anchor" href="#color"></a>
</h3>
<p>By default, the regions are colored by region (i.e. each element in <code>regions_sets</code>). This can be controlled with the <code>colors</code> argument, which accepts a character vector with valid color names and the same length as <code>regions_sets</code></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, regions_sets <span class="op">=</span> <span class="va">regions_sets</span>, color_by <span class="op">=</span> <span class="st">"region"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-12-1.png" width="576" style="display: block; margin: auto;"></p>
<p>If you want to color by strand, just turn <code>color_by</code> to <code>"strand"</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, regions_sets <span class="op">=</span> <span class="va">regions_sets</span>, color_by <span class="op">=</span> <span class="st">"strand"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Now, imagine that we have regions that do not have a defined strand (e.g. most ChIP-seq peaks). In this case, the <code>col_by_strand</code> is internally converted to FALSE and the regions are colored by region set (i.e. elements in <code>regions_sets</code>). Look at this example with only one region set whose strand values are converted to “.”.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Read and format regions file to have strand as "."</span>
<span class="va">regions_no_strand</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.delim</a></span><span class="op">(</span><span class="st">"../testdata/mm10.regions.tsv"</span>, header <span class="op">=</span> <span class="cn">F</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>V6 <span class="op">=</span> <span class="st">"."</span><span class="op">)</span>

<span class="co"># Draw the plot</span>
<span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, 
              regions_sets <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">regions_no_strand</span>, <span class="va">regions_no_strand</span>, <span class="va">regions_no_strand</span><span class="op">)</span>, 
              sets_names   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Regions"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="co"># set colnames because they are mandatory.</span>
              color_by <span class="op">=</span> <span class="st">"strand"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;"></p>
<p>If <code>extra_info</code> is added, <code>color_by</code> can be set to <code>"extra"</code>, which will cause <code>circleRegions</code> to be coloured by the added information. <code>extra_info</code> must be a list of files or data frames with the id of the regions in <code>region_sets</code> (4th column) and an extra column with the (discrete) information you want to use to colour the regions.</p>
<p>This is how a file/data frame within <code>extra_info</code> should look like.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Read and format regions files</span>
<span class="va">extra</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="va">regions_sets</span>, <span class="va">read.delim</span>, header <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/set_names.html" class="external-link">set_names</a></span><span class="op">(</span>nm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"extra1"</span>, <span class="st">"2extra"</span>, <span class="st">"3"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># this is to set the names of the extra info, which will be used as "extra" column</span>
  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="op">~</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">.x</span>, <span class="st">"id"</span> <span class="op">=</span> <span class="va">V4</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/imap.html" class="external-link">imap</a></span><span class="op">(</span><span class="op">~</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">.x</span>, extra <span class="op">=</span> <span class="va">.y</span><span class="op">)</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">extra</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##         id  extra</span>
<span class="co">## 1  region2 extra1</span>
<span class="co">## 2  region4 extra1</span>
<span class="co">## 3  region6 extra1</span>
<span class="co">## 4 region10 extra1</span>
<span class="co">## 5 region18 extra1</span>
<span class="co">## 6 region19 extra1</span></code></pre>
<p>And this is how the plot looks like.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Draw the plot</span>
<span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, 
              regions_sets <span class="op">=</span> <span class="va">regions_sets</span>, 
              sets_names   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Regions"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="co"># set colnames because they are mandatory.</span>
              extra_info <span class="op">=</span> <span class="va">extra</span>,
              color_by <span class="op">=</span> <span class="st">"extra"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-16-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="titles">Titles<a class="anchor" aria-label="anchor" href="#titles"></a>
</h3>
<p>Title and subtitle can be supplied through the arguments <code>title</code> and <code>subtitle</code>, respectively. By default, they are set to NULL, but can accept a character of length 1.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, 
              regions_sets    <span class="op">=</span> <span class="va">regions_sets</span>, 
              title           <span class="op">=</span> <span class="st">"This is a title"</span>, 
              subtitle        <span class="op">=</span> <span class="st">"This is a subtitle"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-17-1.png" width="576" style="display: block; margin: auto;"></p>
<p>Finally, a caption can be included in the bottom-right corner by setting the <code>caption</code> argument. By default, <code>caption</code> is set to NULL and it can be set to TRUE or any character. If <code>caption</code> is set to a character, whatever is written will be placed in the bottom-right corner. Instead, if it is set to TRUE, what will be written will be the number of regions in the input region sets.</p>
<p>Here there is an example with any character:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, 
              regions_sets    <span class="op">=</span> <span class="va">regions_sets</span>, 
              caption         <span class="op">=</span> <span class="st">"This is a caption"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-18-1.png" width="576" style="display: block; margin: auto;"></p>
<p>On the other hand, if <code>caption</code> is set to TRUE, the caption will show the number of regions in the input regions set (<code>regions_sets</code>).</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, 
              regions_sets    <span class="op">=</span> <span class="va">regions_sets</span>, 
              caption         <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-19-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="legend">Legend<a class="anchor" aria-label="anchor" href="#legend"></a>
</h3>
<p>The position of the legend is, by default, the bottom of the plot. This can be changed by changing the <code>legend</code> argument to one of “bottom”, “right”, “top”, “left” or “none” (no legend). The <code>legend</code> argument is passed through <code><a href="https://rpkgs.datanovia.com/ggpubr/reference/theme_pubr.html" class="external-link">ggpubr::theme_pubr()</a></code>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, 
              regions_sets    <span class="op">=</span> <span class="va">regions_sets</span>, 
              legend          <span class="op">=</span> <span class="st">"top"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-20-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/circleRegions.html">circleRegions</a></span><span class="op">(</span>chromsizes_sets <span class="op">=</span> <span class="va">chromsizes_sets</span>, 
              regions_sets    <span class="op">=</span> <span class="va">regions_sets</span>, 
              legend          <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></code></pre></div>
<p><img src="12-circleRegions_files/figure-html/unnamed-chunk-21-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level3">
<h3 id="further-costumization">Further costumization<a class="anchor" aria-label="anchor" href="#further-costumization"></a>
</h3>
<p>Since <code><a href="../reference/chromRegions.html">chromRegions()</a></code> outputs a <code>ggplot2</code>-based bar plot, it can be further customized like any other <code>ggplot2</code>-based plot.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Adria Mitjavila Ventura.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
